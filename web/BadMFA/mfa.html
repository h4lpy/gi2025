<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Insecure MFA Demo</title>
<style>
:root{--bg:#f7f8fa;--card:#fff;--accent:#111827;--muted:#475569}
html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--accent)}
.wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:24px}
.card{width:360px;background:var(--card);border-radius:8px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.08)}
h1{margin:0 0 8px 0;font-size:16px}
label{display:block;font-size:13px;color:var(--muted);margin-top:10px}
input{width:100%;padding:10px;border-radius:6px;border:1px solid #e6e9ef;margin-top:6px;font-size:14px;box-sizing:border-box}
.row{display:flex;gap:8px;margin-top:14px}
button{flex:1;padding:10px;border-radius:6px;border:0;background:#0b5fff;color:#fff;cursor:pointer;font-weight:600}
.muted{font-size:13px;color:var(--muted);margin-top:12px}
.hidden{display:none}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Sign in</h1>

      <form id="loginForm">
        <label for="u">Username</label>
        <input id="u" name="u" type="text"/>
        <label for="p">Password</label>
        <input id="p" name="p" type="password"/>
        <div class="row">
          <button type="submit">Sign in</button>
        </div>
      </form>

      <form id="mfaForm" class="hidden" style="margin-top:12px">
        <label for="m">Enter MFA code</label>
        <input id="m" name="m" type="text" maxlength="128"/>
        <div class="row" style="margin-top:10px">
          <button id="verify" type="submit">Verify</button>
        </div>
      </form>

      <div id="msg" class="muted"></div>
    </div>
  </div>

<script>
(function(){
  const loginForm=document.getElementById('loginForm');
  const mfaForm=document.getElementById('mfaForm');
  const msg=document.getElementById('msg');
  const m=document.getElementById('m');
  let tries=0;

  const token='0123456789012345678901234567890123456789012345678901234567890123'; // 64 digits

  loginForm.addEventListener('submit',function(e){
    e.preventDefault();
    loginForm.classList.add('hidden');
    mfaForm.classList.remove('hidden');
    msg.textContent='A token has been (simulated) sent to your email.';
  });

  mfaForm.addEventListener('submit',function(e){
    e.preventDefault();
    const code=(m.value||'').trim();
    const isDigits=/^\d{64}$/.test(code);

    // Check valid 64-digit input
    if(!isDigits){
      alert('You must input a 64-digit code.');
      tries = 0; // Reset tries
      return;
    }

    // Correct token
    if(code===token){
      window.location.href='flag.html';
      return;
    }

    // Increment failed tries
    tries++;

    // Sequential alerts
    if(tries===1){
      alert('Incorrect code, keep trying.');
    } else if(tries===2){
      alert('Almost there.');
    } else if(tries===3){
      alert('Fine, here is your token: ' + token);
    } else {
      alert('Still incorrect.');
    }
  });
})();
</script>
</body>
</html>
